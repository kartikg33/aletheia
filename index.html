<!--
Copyright (C) 2024 Kartik Gohil

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program. If not, see <https://www.gnu.org/licenses/>.
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>timesync</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>timesync</h1>

        <div class="about">
            <h3>Time Zones, Simplified.</h3>
        </div>

        <div class="actions">
            <a href="https://github.com/kartikg33/timesync" target="_blank" class="button">
                <img src="https://img.icons8.com/nolan/64/github.png" alt="contribute" />
                <span>Contribute</span>
            </a>

            <a href="https://github.com/sponsors/kartikg33" target="_blank" class="button">
                <img src="https://img.icons8.com/nolan/64/trust.png" alt="sponsor" />
                <span>Sponsor</span>
            </a>

            <a target="_blank" class="button" id="add-widget-button">
                <img src="https://img.icons8.com/nolan/64/add.png" alt="add" />
                <span>Add Timezone</span>
            </a>
        </div>

        <div id="widgets-container">
            <div id="widget-container-local"></div>
            <!-- Other widgets will be dynamically added here -->
        </div>
    </div>

    <script src="widget.js"></script>
    <script>
        // Initialize default widgets
        const localTimeWidget = new TimeSelectorWidget('widget-container-local', Intl.DateTimeFormat().resolvedOptions().timeZone);

        // update local time widget
        const localTime = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        const [localHours, localMinutes] = localTime.split(':').map(Number);
        localTimeWidget.updateWidgetTime(localHours * 60 + localMinutes);
        localTimeWidget.hour = localHours;
        localTimeWidget.minute = localMinutes;

        // Add default widgets to the global list for synchronization
        TimeSelectorWidget.instances.push(localTimeWidget);

        // Add event listener to dynamically create new widgets
        const addWidgetButton = document.getElementById('add-widget-button');
        addWidgetButton.addEventListener('click', () => {
        const container = document.getElementById('widgets-container');
        const newWidgetId = `widget-container-${Date.now()}`; // Unique ID for the new widget
        const newWidgetDiv = document.createElement('div');
        newWidgetDiv.id = newWidgetId;
        container.appendChild(newWidgetDiv);

        const newWidget = new TimeSelectorWidget(newWidgetId, 'UTC');
        TimeSelectorWidget.instances.push(newWidget); // Add the new widget to the global list
        });
    </script>
</body>
</html>
